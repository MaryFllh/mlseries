schema: '2.0'
stages:
  pull_data_from_s3:
    cmd: aws s3 cp s3://sent-analysis/reviews.tsv ./data/reviews.tsv
    deps:
    - path: s3://sent-analysis/reviews.tsv
      etag: d8a6be2d1deb19f9cd76f1b69a793b5f
      size: 8481022
    outs:
    - path: ./data/reviews.tsv
      md5: d8a6be2d1deb19f9cd76f1b69a793b5f
      size: 8481022
  prepare_data:
    cmd: docker-compose run sentiment.ml "python -m prepare_data ."
    deps:
    - path: data/reviews.tsv
      md5: d8a6be2d1deb19f9cd76f1b69a793b5f
      size: 8481022
    - path: prepare_data/__main__.py
      md5: 184a55bca30e10448c0be6a8ebabae6e
      size: 715
    outs:
    - path: data/test_data.parquet
      md5: 6c1db524c5f34221de2111af28f1ccc8
      size: 209602
    - path: data/train_data.parquet
      md5: 48a81a15b99c5d77f382b072532da85a
      size: 809624
  train_model:
    cmd: docker-compose run sentiment.ml "python -m train ."
    deps:
    - path: data/train_data.parquet
      md5: 48a81a15b99c5d77f382b072532da85a
      size: 809624
    - path: train/__main__.py
      md5: 5093e3be2d96b3db49bb27e8dcb41e2e
      size: 956
    outs:
    - path: model/lr.model
      md5: 6267d1dacd89020b37e23aa4897456c4
      size: 372435
  test_model:
    cmd: docker-compose run sentiment.ml "python -m test ."
    deps:
    - path: data/test_data.parquet
      md5: 6c1db524c5f34221de2111af28f1ccc8
      size: 209602
    - path: model/lr.model
      md5: 6267d1dacd89020b37e23aa4897456c4
      size: 372435
    - path: test/__main__.py
      md5: 43dfe8f2f68b9e443b8bd5bb18639469
      size: 1102
    outs:
    - path: metrics/model_performance.json
      md5: f7cc37b5f921b5b499131024d676184f
      size: 197
