schema: '2.0'
stages:
  pull_data_from_s3:
    cmd: aws s3 cp s3://mlseries/reviews.tsv ./data/reviews.tsv
    outs:
    - path: ./data/reviews.tsv
      md5: d8a6be2d1deb19f9cd76f1b69a793b5f
      size: 8481022
  prepare_data:
    cmd: docker-compose run sentiment.ml "python -m prepare_data ."
    deps:
    - path: data/reviews.tsv
      md5: d8a6be2d1deb19f9cd76f1b69a793b5f
      size: 8481022
    - path: prepare_data/__main__.py
      md5: 3735f4408950350d4d4e01dd08e7c481
      size: 712
    outs:
    - path: data/test_data.parquet
      md5: 55dc081f8597dc2a23672ba0f5e21572
      size: 207701
    - path: data/train_data.parquet
      md5: bca711a3a546799564fea17163acaa56
      size: 807979
  train_model:
    cmd: docker-compose run sentiment.ml "python -m train ."
    deps:
    - path: data/train_data.parquet
      md5: bca711a3a546799564fea17163acaa56
      size: 807979
    - path: train/__main__.py
      md5: a8f4ee0beae2f6e2c496182f477e8074
      size: 1059
    outs:
    - path: model/lr.model
      md5: 195f200e717430e2635bf8924aa20305
      size: 373693
  test_model:
    cmd: docker-compose run sentiment.ml "python -m test ."
    deps:
    - path: data/test_data.parquet
      md5: 55dc081f8597dc2a23672ba0f5e21572
      size: 207701
    - path: model/lr.model
      md5: 195f200e717430e2635bf8924aa20305
      size: 373693
    - path: test/__main__.py
      md5: 89b83066bd5cf9db1ec20cdd8d205a83
      size: 1102
    outs:
    - path: metrics/model_performance.json
      md5: b527f86cf22cf7de035cd995f5b9349a
      size: 197
