schema: '2.0'
stages:
  pull_data_from_s3:
    cmd: aws s3 cp s3://mlseries/reviews.tsv ./data/reviews.tsv
    outs:
    - path: ./data/reviews.tsv
      md5: d8a6be2d1deb19f9cd76f1b69a793b5f
      size: 8481022
  prepare_data:
    cmd: docker-compose run sentiment.ml "python -m prepare_data ."
    deps:
    - path: data/reviews.tsv
      md5: d8a6be2d1deb19f9cd76f1b69a793b5f
      size: 8481022
    - path: prepare_data/__main__.py
      md5: 3735f4408950350d4d4e01dd08e7c481
      size: 712
    outs:
    - path: data/test_data.parquet
      md5: 107c1e47eb031d3a510ff4b67982df01
      size: 208560
    - path: data/train_data.parquet
      md5: c00f72ae3eb514db3763d63eb75f40ff
      size: 806653
  train_model:
    cmd: docker-compose run sentiment.ml "python -m train ."
    deps:
    - path: data/train_data.parquet
      md5: c00f72ae3eb514db3763d63eb75f40ff
      size: 806653
    - path: train/__main__.py
      md5: a8f4ee0beae2f6e2c496182f477e8074
      size: 1059
    outs:
    - path: model/lr.model
      md5: 5b0b788d688ded723f44a128a629b793
      size: 372957
  test_model:
    cmd: docker-compose run sentiment.ml "python -m test ."
    deps:
    - path: data/test_data.parquet
      md5: 107c1e47eb031d3a510ff4b67982df01
      size: 208560
    - path: model/lr.model
      md5: 5b0b788d688ded723f44a128a629b793
      size: 372957
    - path: test/__main__.py
      md5: 89b83066bd5cf9db1ec20cdd8d205a83
      size: 1102
    outs:
    - path: metrics/model_performance.json
      md5: 5951f4cfc72ebdec1e4b613107ddb12c
      size: 197
