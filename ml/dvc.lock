schema: '2.0'
stages:
  pull_data_from_s3:
    cmd: aws s3 cp s3://sent-analysis/reviews.tsv ./data/reviews.tsv
    deps:
    - path: s3://sent-analysis/reviews.tsv
      etag: d8a6be2d1deb19f9cd76f1b69a793b5f
      size: 8481022
    outs:
    - path: ./data/reviews.tsv
      md5: d8a6be2d1deb19f9cd76f1b69a793b5f
      size: 8481022
  prepare_data:
    cmd: docker-compose run sentiment.ml "python -m prepare_data ."
    deps:
    - path: data/reviews.tsv
      md5: d8a6be2d1deb19f9cd76f1b69a793b5f
      size: 8481022
    - path: prepare_data/__main__.py
      md5: 184a55bca30e10448c0be6a8ebabae6e
      size: 715
    outs:
    - path: data/test_data.parquet
      md5: 3468007c00a678344692fba3a8f0a0e2
      size: 207984
    - path: data/train_data.parquet
      md5: a68981ad72d3bb5db9105ce93ad0dd25
      size: 811272
  train_model:
    cmd: docker-compose run sentiment.ml "python -m train ."
    deps:
    - path: data/train_data.parquet
      md5: a68981ad72d3bb5db9105ce93ad0dd25
      size: 811272
    - path: train/__main__.py
      md5: 5093e3be2d96b3db49bb27e8dcb41e2e
      size: 956
    outs:
    - path: model/lr.model
      md5: fe899cccebe62d6ef0fc795c1c294d79
      size: 371764
  test_model:
    cmd: docker-compose run sentiment.ml "python -m test ."
    deps:
    - path: data/test_data.parquet
      md5: 3468007c00a678344692fba3a8f0a0e2
      size: 207984
    - path: model/lr.model
      md5: fe899cccebe62d6ef0fc795c1c294d79
      size: 371764
    - path: test/__main__.py
      md5: 43dfe8f2f68b9e443b8bd5bb18639469
      size: 1102
    outs:
    - path: metrics/model_performance.json
      md5: 455f99189c9a271eb7fc917df6e24626
      size: 197